2002-03-15  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-services-dispatchers-uri.ads:
	(Dispatch): Fix comment.

	* aws-services-dispatchers-uri.adb:
	(Dispatch): Check if Mode is No_Data instead of Status_Code to 204.

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): Add case for No_Data (does nothing).

	* aws-response.adb:
	(Empty): New function.

	* aws-response.ads:
	(Data_Mode): Add No_Data.
	(Empty): New function.
	(Data): Mode set to No_Data by default.

2002-03-13  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-services-page_server.adb:
	Do not use GNAT.OS_Lib but AWS.OS_Lib instead.

	* aws-dispatchers.adb:
	Remove trailing spaces.

	* aws-server.adb:
	(Initialize): Add pragma Warnings off.

	* aws-services-dispatchers-uri.adb:
	Add missing with clause from previous check-in.

	* aws-services-dispatchers-uri.ads:
	(Dispatch): Add documentation (204 message).

	* aws-services-dispatchers-uri.adb:
	(Dispatch): Continue to next callback if a 204 message is returned
	 by a callback.

2002-03-12  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-url.adb:
	(Parse): Fix bug in parsing URL.

2002-03-08  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-dispatchers.adb:
	(Free): New procedure.
	(Adjust): Change to use reference counter as a pointer.
	(Finalize): Change to use reference counter as a pointer. Free
	 reference counter when set to 0.
	(Initialize): Change to use reference counter as a pointer.
	(Ref_Counter): Returns 0 if Ref_Counter is null and
	 Ref_Counter.all otherwise.

	* aws-dispatchers.ads:
	(Handler): Ref_Counter is an access. Previous implementation was
	 wrong. The reference counter must be shared by all objects.

	* aws-server-protocol_handler.adb:
	(Get_Message_Data): Remove exception handler for Constraint_Error
	 now that Adasockets have its own exception Socket_Error.

	* aws-server.adb:
	(Line): Remove exception handler for Constraint_Error now that
	Adasockets have its own exception Socket_Error.

	* aws.ads:
	(Connection_Error): Removed.

2002-03-03  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(SOURCES): Add missing aws-server-push.adb file.

	* aws-services-dispatchers-virtual_host.adb:
	Put all routines in alphabetical order.

	* aws-session.adb:
	Put all routines in alphabetical order.

	* aws-server-push.adb:
	Put all routines in alphabetical order.
	Minor reformatting.
	
	* makefile:
	(build): Cleanup makefile for GNAT 3.14. (GNAT 3.13 is no more
	 supported).

	* aws-session.adb:
	Minor reformatting.

	* aws-services-dispatchers-uri.adb:
	(Finalize): Workaround missing GNAT 3.14 feature in GNAT.Dynamic_Table
	 which is in 3.15.

	* aws-services-directory.adb:
	Put all routines in alphabetical order.

	* aws-server.adb:
	(Start): Add Server_Host to Bind call.

	* aws-config-set.ads, aws-config-set.adb:
	(Server_Host): New procedure.

	* aws-config.adb:
	(Server_Host): New function.

	* aws-config.ads:
	(Server_Host): New function.
	(Parameter_Name): Add Server_Host into the enumeration.

2002-03-02  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(SOURCES): Rename AWS.Services.Dispatchers.Callback to 
	 AWS.Dispatchers.Callback.

	* aws-server.adb:
	Use AWS.Dispatchers.Callback, this unit does not depend anymore on
	 AWS.Services hierarchy.

	* aws-services-dispatchers-method.ads, 
	  aws-services-dispatchers-method.adb:
	(Register): New routine with a Callback procedure parameter.

	* aws-services-dispatchers-uri.ads, aws-services-dispatchers-uri.adb:
	(Register): New routine with a Callback procedure parameter.
	(Register_Regexp): Idem.
	
	* aws-services-dispatchers-virtual_host.ads,
	  aws-services-dispatchers-virtual_host.adb:
	(Register): New routine with a Callback procedure parameter.

	* aws-services-dispatchers.ads:
	Remove doc for AWS.Services.Dispatchers.Callback.

	* aws-services-dispatchers-callback.ads, 
	  aws-services-dispatchers-callback.adb:
	Moved to AWS.Dispatchers hierarchy.

	* aws-dispatchers-callback.ads, aws-dispatchers-callback.adb:
	Initial revision based on AWS.Services.Dispatchers.Callback.

2002-03-01  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(SOURCES): Add aws-dispatchers.adb remove aws-services-dispatchers.adb

	* aws-services-dispatchers.ads:
	This is now just an empty root package. Add pragma Pure.

	* aws-services-dispatchers.adb:
	Removed.

	* aws-dispatchers.ads, aws-dispatchers.adb:
	Was AWS.Services.Dispatchers. Moved here as this is a general API
	 and can be used outside of the high level services.

	* aws-server-protocol_handler.adb, aws-server.adb, aws-server.ads,
	  aws-services-dispatchers-callback.adb,
	  aws-services-dispatchers-callback.ads,
	  aws-services-dispatchers-method.adb,
	  aws-services-dispatchers-method.ads,
	  aws-services-dispatchers-uri.adb,
	  aws-services-dispatchers-uri.ads,
	  aws-services-dispatchers-virtual_host.adb,
	  aws-services-dispatchers-virtual_host.ads:
	Adjusted to use AWS.Dispatchers API instead of 
	 AWS.Services.Dispatchers.
	
2002-02-26  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Parse_Header): Handle properly the 100 status message (continue).
	Patch from Wiljan Derks.

2002-02-20  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-services-dispatchers-uri.adb,
	  aws-services-dispatchers-virtual_host.adb:
	(Ada.Unchecked_Deallocation): Added.
	(Initialize): Call Dispatchers.Initialize (parent method).
	(Finalize): Call Dispatchers.Finalize (parent method).

	* aws-services-dispatchers.adb:
	(Ada.Unchecked_Deallocation): Moved here from spec.
	(Finalize): Set Ref_Counter to 0.
	(Initialize): Set Ref_Counter to 1.

	* aws-services-dispatchers.ads:
	(Ada.Unchecked_Deallocation): Moved to body.
	(Initialize): Add comments about reference counting.
	(Adjust): Idem.
	(Finalize): Idem.

	* aws-server-push.adb:
	A lot of changes to conform to new spec (see below).

	* aws-server-push.ads:
	Change all Close_Socket parameters to Close_Sockets.
	(Register): Rename Data_Content_Type parameter to Init_Content_Type.
	(Shutdown): Rename Data_Content_Type parameter to Final_Content_Type.

	* aws-services-dispatchers-uri.adb:
	(GNAT.Regexp): Move here from spec.
	(Dispatch): Fix minor type.

	* aws-services-dispatchers-uri.ads:
	(GNAT.Regexp): Move to body.

	* aws-server-push.ads:
	A lot of changes in the spec to make this interface easier to use
	 and understand. Add lot of comments.

	* aws-services-dispatchers-callback.ads,
	  aws-services-dispatchers-callback.ads:
	Initial revision.
	
	* aws-services-dispatchers-method.ads,
	  aws-services-dispatchers-method.adb: 
	Initial revision.

	* aws-services-dispatchers-uri.ads, aws-services-dispatchers-uri.adb:
	Initial revision.

	* aws-services-dispatchers-virtual_host.ads, 
	  aws-services-dispatchers-virtual_host.adb:
	Initial revision.

	* aws-services-dispatchers.ads, aws-services-dispatchers.adb:
	Initial revision.

	* aws-server-protocol_handler.adb:
	(Answer_To_Clien): Call dispatcher instead of Callback.
	Minor reformatting.
	
	* aws-default.ads:
	(Line_Stack_Size): New constant.

	* aws-config.ads, aws-config.adb,
	  aws-config-set.ads, aws-config-set.adb:
	(Line_Stack_Size): New procedure.
	Handle Line_Stack_Size.

	* aws-server.adb:
	(Accept_Socket_Serialize): New function.
	(Start): Remove version with a Callback and add version with a
	 Dispatcher.
	(Line): Call Accept_Socket_Serialized.
	(Semaphore): New protected type used to serialize the Accept
	 statements.
	(Slots.Release): Add some Assert pragmas.
	(Slots.Release): Idem. Add exception handler.
	(Start): New version using a Dispatcher.
	(Start): Add Line_Stack_Size.
	Minor reformatting.
	
	* aws-server.ads:
	(Def_Line_Stack_Size): New constant.
	(Start): New version using a Dispatcher.
	(Start): Add Line_Stack_Size.
	(Line): Add pragma  Storage_Size.
	(Semaphore): New protected type used to serialize the Accept
	 statements.
	(Shutdown): Free Lines.
	(Line_Access): New type.
	(Line_Set): Now an array of Line_Access.
	(HTTP.Sock_Sem): New field (Semaphore).
	(HTTP.CB): Removed.
	(HTTP.Dispatcher): Replace CB since now every callback is based on
	 a more general dispatcher feature.

	* aws-services.ads:
	Add some comments.

2002-02-06  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(SOAP_Post): New routine.
	Patch from Wiljan Derks.
	(Cleaner_Task): Correctly free memory used by the socket.
	
	* aws-client.ads:
	(SOAP_Post): New routine.
	Patch from Wiljan Derks.

2002-02-02  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	Minor comment fix.

	* makefile:
	(SOURCES): Add aws-services-virtual_host.adb.

	* aws-services-virtual_host.ads, aws-services-virtual_host.adb: 
	Initial revision.

	* aws-parameters-set.adb:
	(Reset): Reset Parameter_List.Parameters field.
	(Add): Set Parameter_List.Parameters field.

	* aws-parameters-set.ads: 
	Minor reformatting.

	* aws-parameters.adb:
	(URI_Format): New function.
	Minor reformatting.
	
	* aws-parameters.ads:
	(URI_Format): New function.
	(List): Add Parameters field.

2002-01-30  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.ads:
	(Def_Max_Connect): Correctly set to Default.Max_Connection.

	* aws-server.adb:
	(Start): Set Web_Server.Shutdown to False before starting the lines.

2002-01-29  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.ads:
	(HTTP.Shutdown): Set to True by default as the server is not yet
	 started.

2002-01-28  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-services-page_server.adb:
	(Callback): Do not pad Acknowledge message. For IE this message
	 will be controlled by IE default setting.

2002-01-26  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-templates.ads:
	Initial revision.

	* aws-services-page_server.adb:
	(Callback): Use AWS.Templates to parse 404.thtml template error page.

	* aws-services-page_server.ads:
	Update comment about 404 page, it is now a template.

	* aws-server-protocol_handler.adb:
	Add some comments, minor reformating.

	* aws-services-page_server.ads:
	Add comment about IE and 404 message.

	* aws-services-page_server.adb:
	(Callback): Set status code to 404 when returning the 404.html page.
	 Spaces new constant, use it for 404 message.

	* aws-response.ads, aws-response.adb:
	(File): Add Status_Code parameter.

2002-01-23  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(SOURCES): Add aws-services-page_server.adb.

	* aws-services-page_server.ads, aws-services-page_server.adb:
	Initial revision.

	* aws-services-directory.ads, aws-services-directory.adb:
	Add RCS Id tag.

	* aws-config.ads:
	Fix comment typo.

	* aws-response.ads, aws-response.adb:
	Fix layout.

	* aws-server-protocol_handler.adb:
	Fix minor syntax error.

	* aws-server-get_status.adb:
	(Slot_Table.Peer_Name): Initialize using Peer_Addr and
	 Sockets.Naming.Image.

	* aws-server-hotplug.adb:
	Add Ada.Strings.Unbounded.

	* aws-server-protocol_handler.adb:
	Removes Interfaces.C.
	Removes the Sock parameter.
	(Sock): New variable, initialized using the Slots.

	* aws-server.adb:
	Remove Ada.Unchecked_Conversion, Interfaces.C, Sockets.Thin.
	(Get_Peername): Removed.
	(Protocol_Handler): Remove Sock parameter.
	(Slots): Remove Free.
	(Slots.Get): Update Alive_Counter and Alive_Time_Stamp.
	(Slots.Mark_Phase): Raise Sockets.Connection_Closed if Slot is
	 Aborted and we ask for a Close.
	(Slots.Set_Peer_Addr): New rountine.

	* aws-server.ads:
	Remove Ada.Strings.Unbounded and Sockets (not used).
	(Slot): Remove Peername field, add Peer_Addr, Alive_Time_Stamp, 
	 Alive_Counter.
	(Slots): Remove Set_Peername routine, add Set_Peer_Addr. Remove
	 Free which is not used.

2002-01-16  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-net-stream_io.adb:
	(Free): Do not flush the stream since Shutdown has already been
	 closed.

2002-01-06  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-config-set.ads, aws-config-set.adb:
	(Parameter): New procedure.

2001-12-01  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.adb:
	(Line): handle properly the case where a server is too busy.
	(Line_Cleaner): idem.

2001-11-25  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Cut_Command): Do not Decode URL as parameter name/value should
	 not be decoded yet. Check for pathname/parameters separators '?'
	 and '%3f'.
	(Resource): Decode URI.

	* aws-client.adb:
	(Open_Send_Common_Header): Do not encode URL, only change spaces
	 to '+' to be nice with Windows systems which tends to have spaces
	 anywhere. Only part of the URL needs to be encoded (parameter
	 name, parameter value, host name) and this must be done before
	 calling this code.

	* aws-client.ads:
	Minor indent fix.

	* aws-response.ads, aws-response.adb:
	(Initialize): new procedure.

	* aws-url.adb:
	(Encode): Update comment. Rename parameter from URL to Str. Fix
	 bug in URL length detection.
	(Decode): idem.	

	* aws-url.ads:
	(Encode): Update comment. Rename parameter from URL to Str.
	(Decode): idem.

	* aws-response.ads:
	(Data): Ref_Counter is now an access type. Previous implementation
	 was wrong.
	
	* aws-response.adb:
	Change all reference counters initialization.

2001-11-24  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	Release memory for binary data in the exception handler.
	
	* aws-server-protocol_handler.adb:
	(Parse_Request_Line): correctly decode resource and parameters. Use
	 AWS.URL.Decode instead of AWS.Translator.Decode_URL.

	* aws-url.adb:
	(Decode): add check for 2 numbers after '%' character.

	* aws-parameters-set.adb:
	(Add): Use AWS.URL.Decode instead of AWS.Translator.Decode_URL. 

	* aws-translator.ads, aws-translator.adb:
	(Decode_URL): removed.

	* aws-client.adb:
	Use AWS.URL.Host instead of Server_Name.

2001-11-23  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-url.adb:
	(Host): new procedure (same proc than Server_Name).
	(Path): new procedure.
	(File): new procedure.
	(Pathname): was URI.
	(Decode): new function.
	(Parse): Use Path and File instead of URI.
	(URL): use Pathname.

	* aws-url.ads:
	(Host): new procedure (same proc than Server_Name).
	(Path): new procedure.
	(File): new procedure.
	(Pathname): was URI.
	(Decode): new function.
	(Object): remove URI, add Path and File.

	* aws-response.ads:
	(Data): Add comment about type not being threda safe.

	* aws-client.adb:
	(Get_Response): New implementation for case Content-Length = 0 and
	 binary data.

	* aws-server-protocol_handler.adb:
	Release memory for binary data at the end of the loop.
	Minor reformatting.

2001-11-22  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-url.adb:
	(Code): new procedure.
	(Hex_Escape): new constant array.
	(Encode): encode all characters not only spaces.

	* aws-response.ads:
	(Data): is now a controlled type to be able to free the memory
	 used for the binary data.
	(Adjust): new procedure.
	(Finalize): new procedure.
	
	* aws-response.adb:
	Fix all aggregates since Data is now a controlled type.
	(Adjust): new procedure.
	(Finalize): new procedure.

	* aws-client.adb:
	(Get_Response): use MIME.Is_Text to correctly handle textual and
	 non textual data.

	* aws-mime.ads, aws-mime.adb:
	(Is_Text): new function.

2001-11-12  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-translator.adb:
	Change implementation of BASE64 algorithm. It is now based on
	 base64 tables instead of functions. Removes use of unbounded
	 string, now the result length is computed before the encoding. 
	 This should be faster. This code has been contributed by 
	 Thomas Quinot.

2001-11-06  Pascal Obry  <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): set to 1.2.

	* aws-server.adb:
	(Counter): new protected record.
	(Wait): new procedure.
	(Initialize): new procedure.
	(Finalize): decrement counter.
	
	* aws-server.ads:
	(Termination): new type.
	(Wait): new procedure.
	(Initialize): new procedure.

2001-11-02  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session.adb:
	(Database.Touch_Session): new protected procedure?
	(Touch): new procedure.
	Put routines in alphabetical order.

	* aws-session.ads:
	(Touch): new procedure.
	Add comments to iterators.

2001-10-31  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-push.ads, aws-server-push.adb:
	(Object.Send): rename Not_Responding parameter to Unregistered.

2001-10-30  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-push.adb:
	(Send_G): new procedure.
	(Object.Send): add Not_Responding parameter.
	(Send_To): fix bug to detect an invalid client ID.

	* aws-server-push.ads:
	(Send_G): new procedure.
	(Object.Send): add Not_Responding parameter.
	Minor typo fix.

2001-10-24  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-push.adb:
	(Register): in Plain mode send a new line.
	
	* aws-server-push.adb:
	(Register): new version that does not raise exception but return a
	 boolean if duplicate item found.
	(Object): put routines in alphabetical order.
	(Object.Unregister): catch exception since it should not be propagated.

	* aws-server-push.ads:
	(Duplicate_Client_ID): new exception.
	(Register): new version that does not raise exception but return a
	 boolean if duplicate item found.
	(Object): add comments for protected routines and put them in
	 alphabetical order.

2001-10-18  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-net-stream_io.adb:
	(Initialize): removes Last initialization from here.

	* aws-net-stream_io.ads: 
	(Write_Cache): Initialize Last to 0.

2001-10-17  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(SOURCES): add aws-net.adb and aws-net-stream_io.adb

	* aws-server-push.ads:
	Add some comments about MSIE and Server Push.
	(Socket_Type): use Aws.Net.Stream_IO.Socket_Type.
	Many changes to fix Server Push and SSL. Use AWS.Net.Stream_IO
	 which should be more efficient.
	(Object.Count): new procedure.
	(Object.Destroy): new procedure.

	* aws-server-push.adb:
	Many changes to fix Server Push and SSL. Use AWS.Net.Stream_IO
	 which should be more efficient.
	(Boundary): smaller boundary prefix.
	(Object.Count): new procedure.
	(Object.Destroy): new procedure.
	(Send_Data): flush stream.
	(Register): flush stream.

	* aws-net-stream_io.ads, aws-net-stream_io.adb:
	Initial revision.

2001-10-16  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-push.adb:
	(Close): correctly free the sockets (needed for SSL) before
	 releasing the memory.

2001-10-14  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-net-std.adb:
	Minor layout fix.

	* aws-net-ssl.adb:
	Minor layout fix.

2001-10-13  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session-control.adb, aws-translator.adb: 
	Put all routines in alphabetical order.

	* aws-server.adb, aws-server-protocol_handler.adb:
	Put all routines in alphabetical order.

	* aws-net-ssl.adb, aws-net-std.adb:
	Put all routines in alphabetical order.

	* aws-client.adb, aws-hotplug.adb, aws-messages.adb:
	Put all routines in alphabetical order.

2001-10-12  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(clean): fix temp CVS file pattern.

	* aws.ads:
	Fix typo in header.

	* aws-utils.ads, aws-utils.adb:
	Fix typo in header.

	* aws-url.ads, aws-url.adb:
	Fix typo in header.

	* aws-translator.ads, aws-translator.adb:
	Fix typo in header.

	* aws-status.ads, aws-status.adb:
	Fix typo in header.

	* aws-status-set.ads, aws-status-set.adb:
	Fix typo in header.

	* aws-session.ads, aws-session.adb:
	Fix typo in header.

	* aws-session-control.ads, aws-session-control.adb:
	Fix typo in header.

	* aws-services.ads:
	Fix typo in header.

	* aws-services-directory.ads, aws-services-directory.adb:
	Fix typo in header.

	* aws-server.ads, aws-server.adb:
	Fix typo in header.

	* aws-server-push.ads, aws-server-push.adb:
	Fix typo in header.

	* aws-server-protocol_handler.adb:
	Fix typo in header.

	* aws-server-hotplug.ads, aws-server-hotplug.adb:
	Fix typo in header.

	* aws-server-get_status.ads, aws-server-get_status.adb:
	Fix typo in header.

	* aws-response.ads, aws-response.adb:
	Fix typo in header.

	* aws-parameters.ads, aws-parameters.adb:
	Fix typo in header.

	* aws-parameters-set.ads, aws-parameters-set.adb:
	Fix typo in header.

	* aws-os_lib.ads:
	Fix typo in header.

	* aws-net.ads:
	Fix typo in header.

	* aws-net-std.adb, aws-net-std.adb:
	Fix typo in header.

	* aws-mime.ads, aws-mime.adb:
	Fix typo in header.

	* aws-messages.ads, aws-messages.adb:
	Fix typo in header.

	* aws-log.ads, aws-log.adb:
	Fix typo in header.

	* aws-key_value.ads:
	Fix typo in header.

	* aws-hotplug.ads, aws-hotplug.adb:
	Fix typo in header.

	* aws-hotplug-get_status.ads, aws-hotplug-get_status.adb:
	Fix typo in header.

	* aws-default.ads:
	Fix typo in header.

	* aws-config.ads, aws-config.adb:
	Fix typo in header.

	* aws-config-set.ads, aws-config-set.adb:
	Fix typo in header.

	* aws-config-ini.ads, aws-config-ini.adb:
	Fix typo in header.

	* aws-communication.ads, aws-communication.adb:
	Fix typo in header.

	* aws-communication-server.ads, aws-communication-server.adb:
	Fix typo in header.

	* aws-communication-client.ads, aws-communication-client.adb:
	Fix typo in header.

	* aws-client.ads, aws-client.adb:
	Fix typo in header.

	* aws-server.ads:
	Fix style (trailing spaces).

	* aws-server-push.ads, aws-server-push.adb:
	(Data_For): renamed Send_To.
	(Broadcast): renamed Send.

	* aws-server.adb:
	(Line): loop until HTTP_Server.Shutdown is true.
	(Shutdown): wait for 0.5 second between each check for Cleaner
	 task termination. Idem for lines termination. 
	(Slots.Shutdown): new procedure.
	(Abort_On_Timeout): call Shutdown for the right index.
	(Release): correctly detect when a sockets need to be shutdown and
	 free memory associated with the socket handle.

	* aws-server.ads:
	(Slot_Phase): add Aborted.
	(Socket_Access): new type.
	(Slot): Sock is now a Socket_Access.
	(Slots.Get): FD parameter is now a Socket_Access.
	(Slots.Shutdown): new procedure.

	* aws-server-get_status.adb:
	(Slot_Table): Sock is now an access type, use .all to access object.

	* aws-net-ssl.adb:
	(Free): new procedure.

	* aws-net-std.adb:
	(Free): new procedure.

	* aws-net.ads:
	(Free): new procedure.

2001-10-09  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-default.ads:
	(One_Hour): new constant.
	(One_Minute): idem.
	Use above constants to define the timeouts.

2001-10-08  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session.adb:
	Minor layout fix.

	* aws-client.adb:
	(Get): close connection if an exception is raised.
	(Head): idem.
	(Post): idem.
	(Put): idem.

	* aws-url.adb:
	(Normalize): handle properly the "/./" case.

2001-10-06  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Create): Retry is now a Natural.
	(Close): be sure to not call the task if already terminated.
	(Cleaner_Task): add some comments.

	* aws-client.ads:
	(Retry_Default): set to 0.
	(Create): Retry is now a Natural.
	(HTTP_Connection): idem.

	* aws-url.adb:
	(Normalize): Fix layout.

2001-10-04  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Debug_On): new variable.
	(Debug_Release): new procedure.
	(Send_Header): new routine.
	(Debug_Message): new routine.
	(Get_Response): handle properly the textual data chunked encoded.
	(Open_Send_Common_Header): send data using Send_Header.
	(Parse_Header): call debug message for each header line.
	(Post): send data using Send_Header.
	(Put): send data using Send_Header.

	* aws-client.ads:
	(Set_Debug): new routine.

2001-10-03  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Get_Response): Fix bug in 404 message handling. The message body
	 was not read.

	* aws-url.adb:
	(Parse): correctly set the default port for HTTPS protocol. Checks
	 for wrong URL starting with "/..".
	(URL.Port): properly handle default HTTPS port.

	* aws-url.ads:
	(Default_Port): renamed Default_HTTP_Port.
	(Default_HTTPS_Port): new constant.

2001-10-01  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Get): Correctly set the timeouts in the Connection.
	(Head): idem.
	(Put): idem.
	(Post): idem.
	(Get_Response): handler 404 message. Correctly set the phase for
	 message 404, 301 and when no body is returned.

	* aws-server.adb:
	(Line): Send output in exception handler to Current_Error.

	* aws-url.adb:
	(Parse): Fix another bug with parsing non-rooted URL. Found while
	 working on the regression test suite.

	* aws-response.ads, aws-response.adb:
	(Build): rename parameter Message_Body to UString_Message. This
	 will help raising ambiguity with Templates_Parser.Parse which can
	 returns a String or an Unbounded_String.

2001-09-30  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Create): correctly set the timeouts. Found while working on the
	 regtest suite.

	* aws-url.adb:
	(Parse): ignore empty URL.
	
	* aws-url.adb:
	(Parse): properly check for URI without server and port
	 information.
	(URL): if this is a simple URI (no server info) return the URI.

	* aws-client.adb: 
	(Get): add Timeouts parameter.
	(Head): idem.
	(Put): idem.
	(Post): idem.
	(Get): correctly report a timeout with a 408 message code.
	(Head): idem.
	(Put): idem.
	(Post): idem.
	(SOAP_Post): idem.
	(Set_Phase): new procedure.
	(Open_Send_Common_Header): set properly phase at the start and the
	 end of the routine.
	(Get_Response): idem.
	Put routines in alphabetical order.
	
	* aws-client.ads:
	(Timeouts_Values): new type.
	(Get): add Timeouts parameter.
	(Head): idem.
	(Put): idem.
	(Post): idem.
	(HTTP_Connection): add With_Timeouts discriminant and it is now a
	 limited private type. Add parameters Current_Phase, Timeouts and
	 Cleaner.
	(Create): now a procedure (was a function) this is required to be
	 able to initialize the limited private type.
	(Client_Phase): new type.
	(Cleaner_Task): new task type.
	(Cleaner_Access): an access type to task type above.
	(Build_Cleaner): new function.

2001-09-27  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-url.ads, aws-url.adb:
	(Normalize): new procedure.
	(URL): new function.

	* aws-server.adb:
	(Shutdown): reorder again the termination phases. safer and should
	 avoid lock.

	* aws-server.ads:
	(Release): fix comments.

2001-09-26  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-push.ads:
	Update comments.

	* aws-server-protocol_handler.adb:
	(Get_Message_Header): removes exception handler since it is not
	 needed.

	* aws-url.adb:
	(URI): add parameter Encode.
	(Encode): new function.
	Put routines in alphabetical order.
	
	* aws-url.ads:
	(URI): add parameter Encode.
	(Encode): new function.

	* aws-client.adb:
	(Open_Send_Common_Header): Encode URI in the HTTP header. This is
	 needed if the URI has some spaces for example.

2001-09-24  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Get_Message_Header): Optimize parsing of header line.

	* aws-client.adb:
	(Get_Response): Use a string to build the response. Previous
	 algorithm using Unbounded_String was very very slow for big page.

2001-09-21  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	Change a lot of things to ease build step.

	* aws-server-push.adb:
	Minor reformating.

	* aws-client.ads:
	Fix typos in comment.

	* aws-config-set.ads:
	Fix typos in comment.

	* aws-config.ads:
	Fix typos in comment.

	* aws-server.ads:
	Fix typo in comment.

	* aws-status.ads:
	Fix typo in comment.

2001-09-20  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.ads:
	(Start): fix comment.

	* aws-log.adb:
	(Stop): check if file is open before closing it.

	* aws-server.adb:
	(Shutdown): Correctly wait for tasks to terminate before releasing
	 the memory. Further fix to avoid memory leak. Close the log.
	(Start): Properly set Web_Server.Shutdown to False. Fix problem
	 when starting/stopping a server.

	* aws-server.ads:
	(Shutdown): update comment.
	Fix typo.

2001-09-19  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.adb:
	(Line): do not handle Constraint_Error as an internal
	 error. AdaSockets has a bug and sends Constraint_Error when a
	 socket is closed while sending data. Constraint_Error should be
	 removed from the handler when this bug will be fixed.

	* aws-config-ini.adb:
	(Error_Message): Send error message to Current_Error.

	* aws-server.adb:
	(Line): Send error message to Current_Error.

	* aws-session.adb:
	(Cleaner): Send error message to Current_Error.

2001-09-14  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-log.adb:
	Removes empty line at end of file.

	* aws-messages.adb: 
	(Content_Type): add boundary data.
	(Transfer_Encoding): new function.

	* aws-messages.ads:
	Inline all constructor functions.
	(Content_Type): add boundary data.
	(Transfer_Encoding): new function.

	* aws-mime.ads:
	(Multipart_Mixed_Replace): new constant.

	* aws-server-push.adb:
	(Register): Use AWS.Messages constructors and AWS.MIME type to
	 build the response message.
	(Send_Date): Use AWS.Messages constructors to build the response
	 message.

	* aws-log.adb:
	Minor reformating.
	Add some comments.
	(Write): Undo previous change about log time format. This was
	 wrong since we want to keep compatibility with Apache log.

2001-09-13  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-response.ads: 
	Minor reformating.

	* aws-server-protocol_handler.adb:
	(Create_Session): check using No_Session constant.
	(Send_General_Header): convert the session ID using Session.Image
	 routine.

	* aws-session.adb:
	(Value): returns No_Session if SID is not a recognized AWS session ID.

	* aws-session.ads:
	(No_Session): new constant.
	(Value): add some comment.
	Reformating.

	* aws-status-set.adb:
	(Reset): D.Sesison_ID is now set to AWS.Session.No_Session.
	(Session): uses AWS.Session.Value to set D.Session_ID.

	* aws-status-set.ads:
	Minor reformating.

	* aws-status.adb: 
	(Has_Session): check using AWS.Session.No_Session which is cleaner.
	(Session): remove version returning a string (it is always
	 possible to use AWS.Session.Image to do so).

	* aws-status.ads:
	Add lot of comments.
	(Session): remove version returning a string (it is always
	 possible to use AWS.Session.Image to do so).
	(Data): Session_ID is not a Session.ID type.

	* aws-translator.ads: 
	Minor comment fix.

	* aws-url.adb:
	Reformating.

	* aws-session.ads: 
	Reformating.

	* aws-log.adb: 
	(Write): Fix log format. Minor reformating.

2001-09-12  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session-control.adb:
	(Shutdown): Ask for termination of Cleaner_Control task. Release
	 the memory for the task access. Fix a memory leak.

	* aws-session.adb:
	(Cleaner): wait for next run and eventually accept a Stop
	 rendez-vous. In this case the task will exit from the loop.
	(Cleaner_Control.Stop): Returns now a boolean to tell if the session
	 cleaner task can be terminated or not.
	
	* aws-session.ads:
	(Cleaner): add entry Stop.
	(Cleaner_Control.Stop): Returns now a boolean to tell if the session
	 cleaner task can be terminated or not.
	(Cleaner_Task): put declaration outside the Cleaner_Control object.

2001-09-11  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.adb:
	(Shutdown): do nothing if the server has already been shutdown.

2001-09-10  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-communication-server.adb:
	(Start): Initialize Com_Server without discriminant, and set the
	 number of connection in Server.Start call.

	* aws-log.adb:
	Fix style.

	* aws-server-get_status.adb:
	Use Max_Connection from the server properties.

	* aws-server.adb: 
	(Shutdown): release memory allocated for the slots HTTP field. Use
	 Max_Connection from the server properties.
	(Start): add parameter Max_Connection. Use Max_Connection from the
	 server properties.
	(Line): Use Max_Connection from the server properties.
	(Finalize): new routine for HTTP limited controlled type.

	* aws-server.ads:
	(HTTP): remove Max_Connection discriminant. It is now a limited
	 controlled object, ressources will be freed automatically when
	 leaving the HTTP variable scope. Field Slots is now an access type.
	(Start): add parameter Max_Connection.
	(Finalize): new routine for HTTP limited controlled type.

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): Removes Peername parameter in Log.Write call
	 since it is not needed anymore.

	* aws-log.adb:
	(Write): new procedure. For user's log.
	Use AWS.OS_Lib instead of GNAT.OS_Lib.
	
	* aws-log.ads:
	(Write): remove Peername which is now into the connection status.
	(Write): new procedure. For user's log.
	Add some comments.

	* aws-server-get_status.adb:
	(Translations): Add START_TIME tag.

	* aws-server.adb:
	(Start): Set the Start_Time field with current date and time.

	* aws-server.ads:
	(HTTP): Add Start_Time field.

	* aws-server-protocol_handler.adb:
	Removes a duplicate with line for Stream_IO.
	Add some comments.
	Minor layout fix.

	* aws-server.adb:
	(Shutdown): release memory for new task access.
	(Start): minor layout change.
	(Start): create tasks objects.

	* aws-server.ads:
	(Line_Set_Access): new type.
	(Line_Cleaner_Access): new type.
	(HTTP): use Line_Cleaner_Access and Line_Set_Access to avoid
	 creating the tasks when HTTP object is created.

2001-09-06  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Send_General_Header): use Messages.Connection constructor.

2001-09-05  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Send_File_Size): removed. Use directly the Messages.Content_Length
	 constructor and the Answer message length which is now always
	 correct (for message and file).
	(Send_File): add File_Size parameter.
	(Send_File_Time): use Messages.Last_Modified constructor.

	* aws-response.adb:
	(File): compute the file size and set the content length field
	 properly (was always set to 0).
	 (Module): 

	* aws-messages.adb: 
	(Last_Modified): new constructor.
	(Location): use Location_Token constant instead of string.

	* aws-messages.ads:
	(Last_Modified_Token): new constant.
	(Last_Modified_Range): new subtype.
	(Last_Modified): new constructor.

	* aws-log.adb: 
	(Write): Add parameter Answer and removes Answer_Stat. Write the
	 content length that has been transfered. Now the log format is
	 the same than most standard Web servers.

	* aws-log.ads:
	(Write): Add parameter Answer and removes Answer_Stat. This is
	 need to add the data size transfered in the log.

2001-09-03  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session.adb:
	(Key_Exist): Add exception handler to properly exit from this
	 routine and set Result to False.

2001-09-02  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-messages.ads:
	(Referer_Token): new constant.
	(Referer_Range): new subtype.

	* aws-server-protocol_handler.adb:
	(Parse): handles User_Agent and Referer fields.

	* aws-status-set.ads, aws-status-set.adb:
	(User_Agent): new procedure.
	(Referer): new procedure.
	
	* aws-status.adb:
	(User_Agent): new function.
	(Referer): new function.

	* aws-status.ads:
	(User_Agent): new function.
	(Referer): new function.
	(Data): add User_Agent and Referer field.

2001-08-31  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-config-ini.adb: 
	(Read): parameters' value is now everything after the parameter name.

2001-08-30  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	Minor style fix.

	* aws-server.adb:
	(Start): Use Accept_Queue_Size configuration parameter in the call
	 to Listen.

	* aws-config-set.ads, aws-config-set.adb:
	(Accept_Queue_Size): new procedure to set the accepting queue
	 size. This help support heavy loaded server.

	* aws-config.adb:
	(Accept_Queue_Size): new function to retrieve the accepting queue
	 size. This help support heavy loaded server.

	* aws-config.ads:
	(Accept_Queue_Size): new function to retrieve the accepting queue
	 size. This help support heavy loaded server.
	(Parameter_Name): add Accept_Queue_Size.
	(Default_Parameter): add Accept_Queue_Size.

	* aws-default.ads:
	(Accept_Queue_Size): new constant.

	* aws-client.adb:
	Removes unused with clause (Ada.Text_IO).

2001-08-26  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Send_Message): change Put_Line by a simple Put. Fix a problem
	 when sending big message.
	(Get_Message_Data): Uses MIME.Appl_Form_Data instead of
	 Messages.Form_Data. Idem for MIME.Multipart_Data. Check for SOAP
	 message and correctly set the payload request in this case.
	(Parse): parse the SOAPAction HTTP header.
	This is work to support SOAP over HTTP.	

	* aws-client.adb:
	(Send_Command): rename to Open_Send_Common_Header.
	(Get_Response): check for HTML and XML message to support SOAP
	 message.
	(SOAP_Post): new function. This is to support SOAP request over
	 HTTP.
	(Open_Send_Common_Header): Use No_Data to check for cookie. Add
	 SOAPAction header if needed.
	(Create.Set): New function.
	(Create): correctly set to Null_Unbounded_String string that are
	 not initialized.
	Declare all Try_Count variables as Natural.
	(Post): Add SOAPAction checks.
	Fix layout.

	* aws-client.ads:
	(SOAP_Post): new function. This is to support SOAP request over
	 HTTP.
	(Create): add SOAPAction parameter.
	(HTTP_Connection): Add field SOAPAction.

	* aws-messages.adb:
	(SOAPAction): new function.

	* aws-messages.ads:
	(SOAPAction): new function.
	(SOAPAction_Token): new constant.
	(SOAPAction_Range): new type.
	(Form_Data): moved to AWS.MIME.
	(Multipart_Form_Data): moved to AWS.MIME.

	* aws-status-set.ads, aws-status-set.adb:
	(SOAPAction): new procedure.
	(Payload): new procedure.
	This is work to support SOAP over HTTP.
	Fix layout.

	* aws-status.adb:
	(Is_SOAP): new function.
	(SOAPAction): new function.
	(Payload): new function.
	This is work to support SOAP over HTTP.

	* aws-status.ads:
	Fix parameters.
	(Is_SOAP): new function.
	(SOAPAction): new function.
	(Payload): new function.
	This is work to support SOAP over HTTP.

	* aws-mime.adb:
	(Dot_XML): new constant.
	(Type_Table): add Dot_XML to handle XML files.

	* aws-mime.ads:
	(Text_XML): new constant.
	(Appl_Form_Data): idem.
	(Multipart_Form_Data): idem.

	* aws-url.adb:
	Fix layout.

	* aws-url.ads:
	Add comments.

2001-08-19  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	Properly inititialize P_List before using it.

	* makefile:
	(build): add aws-server-push.adb in the list of file to not
	 compile with style check.

	* aws-server-push.adb:
	Fix casing error.

	* aws-client.adb: 
	(Parse_Header): add Cookie parameter which is set when parsing
 	 header. This part of the header was just ignored before.
	(Send_Command): output Set-Cookie: HTTP header if needed.

	* aws-client.ads: 
	(HTTP_Connection): add Cookie field to support HTTP client cookies.

	* aws-messages.ads:
	(Set_Cookie_Token): new constant.

	* aws-server-push.ads, aws-server-push.adb:
	Fix copyright notice.

	* aws.ads:
	(Version): set to 1.1.

2001-08-17  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.adb:
	Minor style fix.

	* aws-server-protocol_handler.adb:
	Many changes to support server push.
	(Socket_Taklen): new boolean.
	(Answer_To_Client): set socket in status data before calling
	 user's callback. Check for Soket_Taken answer.
	(Send_File_Chuncked.Hex): moved to AWS.Utils.
	Exit main loop if the Socket has been taken by user's.

	* aws-server-push.ads, aws-server-push.adb:
	Initial revision.

	* aws-status-set.adb: 
	(Socket): new procedure.
	
	* aws-status-set.ads: 
	(Socket): new procedure.
	Fix layout.

	* aws-status.adb:
	Put routines in alphabetical order.

	* aws-utils.ads, aws-utils.adb:
	(Hex): Moved here from Protocol_Handler.

2001-08-16  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-parameters.ads:
	(List): do not initialize Data field. This is now done by Reset to
	 avoid memory leak.

	* aws-parameters-set.adb: 
	(Reset): destroy data if it exists otherwise create an empty set.
	(Free): new procedure.

	* aws-parameters-set.ads:
	(Reset): fix comment.
	(Free): new procedure.

	* aws-status.ads, aws-status.adb:
	Miror reformating.

	* aws-server-protocol_handler.adb:
	(Socket_Taken): new boolean.

	* aws-status.adb:
	(Socket): new function.

	* aws-status.ads:
	(Socket): new function.
	(Data): add field Socket.

	* aws-server.adb:
	(Socket_Taken): new procedure in Slots protected object.
	(Release): do not shutdown Socket if it has been "taken".

	* aws-server.ads:
	(Socket_Taken): new procedure in Slots protected object.
	(Slot): add boolean field Socket_Taken.

	* aws-response.adb: 
	(Socket_Taken): new constructor function.

	* aws-response.ads:
	(Socket_Taken): new constructor function.
	(Data_Mode): Add Socket_Taken to the enumeration.

	* aws-server-protocol_handler.adb:
	Remove call to AWS.Parameters.Set.Reset has this this already done
	 by AWS.Status.Set.Reset.

	* aws-services-directory.adb:
	Close directory iterator and destroy internal tree (fix memory leak).

	* aws-status-set.adb:
	(Reset): call AWS.Parameters.Set.Reset.
	Minor reformating.

2001-08-08  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-config.ads:
	Style fix.

	* makefile:
	(clean): removes Emacs VC *~ files.
	
	* aws-default.ads, aws-config.ads, aws-config.adb,
	  aws-config-set.ads, aws-config-set.adb:
	Rename Log_File_Prefix to Log_Filename_Prefix.

	* aws-server.ads:
	(Start): removes Log_Split_Mode parameter, this is now on
	 Start_Log routine.
	(Start_Log): add Split_Mode and Filename_Prefix parameters.

	* aws-server.adb:
	(Start): removes Log_Split_Mode parameter, this is now on
	 Start_Log routine.
	(Start): do not set SO_REUSEADDR for the accepting server socket.
	(Start_Log): add Split_Mode and Filename_Prefix parameters. Set
	 the configuration accordingly.

2001-08-07  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-config.adb, aws-config-set.adb, aws-config-ini.adb: 
	Lot of changes to accommodate for new Object declaration.

	* aws-config.ads: 
	(Object): now a record to be able to initialize the all parameters.

	* aws-log.ads: 
	(Object): Initialize Split field.

	* aws-server-protocol_handler.adb: 
	Use CNF renaming for AWS.Config to avoid name clash.
	Pass the Log object when writting log info.

	* aws-server-get_status.adb:
	(Translations): Add LOG, LOG_FILE, LOG_MODE tag.

	* aws-config-ini.adb:
	Reorganize the code. Now the Read procedure update the
	 configuration object by reading only the filename passed in
	 parameter. The Server_Config object is updated at elaboration
	 time by reading 'aws.ini' and 'prognam.ini' files.

	* aws-config-ini.ads: 
	(Read): update comment.

	* aws-config.ads:
	(Get_Current): update comments.

	* aws-server.adb:
	Support the per-server logging facility.
	(Start): Add Log_Split_Mode parameter.
	(Config): new function.
	(Start_Log): new procedure.
	(Stop_Log): new procedure.
	Put routines in alphabetical order.

	* aws-server.ads:
	Support the per-server logging facility.
	(Start): Add Log_Split_Mode parameter.
	(Config): new function.
	(Start_Log): new procedure.
	(Stop_Log): new procedure.

	* aws.ads: 
	(Version): set to 1.0.

2001-08-06  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-config.adb: 
	With AWS.Config.Ini to initialize options set.
	(Get_Current): new function.
	(Log_File_Prefix): idem.
	(Log_Split_Mode): idem.
	(Session_Cleanup_Interval): remove object parameter as this is a
	 per-process option.
	(Session_Lifetime): idem.

	* aws-config.ads:
	Add support for 2 new options, Log_File_Prefix and Log_Split_Mode.
	Split the handling for per-process and per-server options.
	(Get_Current): new function.
	(Log_File_Prefix): idem.
	(Log_Split_Mode): idem.
	(Session_Cleanup_Interval): remove object parameter as this is a
	 per-process option.
	(Session_Lifetime): idem.
	(Server_Config): new variable to old per-process options.

	* aws-log.ads, aws-log.adb:
	A lot of changes to make this package an ADT.
	(Start): add Log, File_Directory and Filename_Prefix parameter.
	(Write): add Log object parameter.
	(Stop): idem.
	(Is_Active): new function.
	(Filename): idem.
	(Mode): idem.

	* aws-default.ads:
	(Log_File_Prefix): new constant.
	(Log_Split_Mode): new constant.

	* aws-config-set.ads, aws-config-set.adb:
	(Log_File_Prefix): new procedure.
	(Log_Split_Mode): new procedure.
	(Session_Cleanup_Interval): remove object parameter as this is a
	 per-process option.
	(Session_Lifetime): idem.

	* aws-config-ini.adb: 
	(Read): was a function it is now a procedure to be able to update
	 the configuration object. Handle per-server and per-process
	 options.
	Initialize Server_Config at elaboration.
	
	* aws-config-ini.ads: 
	(Read): was a function it is now a procedure to be able to update
	 the configuration object.

2001-08-05  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.adb:
	(Start): Fix typo.

	* aws-server.ads:
	(Def_Port): fix typo in constant declaration.

	* aws-default.ads:
	(Server_Name): new constant.

	* aws-server-protocol_handler.adb:
	Lot of changes to use new configuration API.
	(Answer_File): new procedure.

	* aws-server.ads, aws-server.adb:
	Lot of changes to use new configuration API.
	(Start): new routine using a configuration object to initialize
	 the server properties.
	(Set_Timeouts): new Slots protected procedure to set all server
	 timeouts.

	* aws-server-get_status.adb:
	(Translations): change table to use new configuration API.

	* aws-session-control.ads, aws-session-control.adb:
	(Start): add two parameters to control the session server.
	
	* aws-session.ads, aws-session.adb:
	(Start): add two parameters to control the session server.

2001-08-04  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(SOURCES): add aws-config, aws-config-ini, aws-config-set, aws-default

	* aws-config-ini.ads:
	Update comment.

	* aws-config-set.ads:
	Reorder routine.

	* aws-config.adb: 
	A lot more changes to support ADT. All values moved to sepc.
	(Initialize): moved to AWS.Config.Ini.
	(Session): new function.
	(Security): new function.
	(Case_Sesitive_Parameters): new function.

	* aws-config.ads:
	Move constants for default AWS parameters into AWS.Default.
	This package is now designed as an ADT instead of an ASM. It is
	 then possible to have a configuration per server instead of per
	 process.
	All variables are move into the private part here to be accessible
	 from AWS.Config.Set.
	(Session): new function.
	(Security): new function.
	(Case_Sesitive_Parameters): new function.
	A lot more changes to support ADT.

	* aws-default.ads:
	Initial revision.

	* aws-config-set.ads, aws-config-set.adb: 
	Initial revision.

	* aws-config-ini.ads, aws-config-ini.adb:
	Initial revision.

2001-07-31  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.ads: 
	Minor reformating.

	* aws-log.adb: 
	(Log_Prefix): returns either the specicifed prefix or the program
	 name.
	(Start): add Log_File_Prefix field to control the log filename.

	* aws-log.ads:
	(Start): add Log_File_Prefix field to control the log filename.
	Minor reformating.

	* aws-log.adb:
	(Start): add code to handle Each_Run mode.

	* aws-log.ads: 
	(Split_Mode): add Each_Run to have a new log file every time the
	 server is started.
	Fix and add comments.

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): check for empty Admin_URI. Now all URI
	 starting by Admin_URI are reserved. Speed up a bit the code.

2001-07-30  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-config.ads: 
	Minor reformating.

2001-07-28  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile: 
	(SOURCES): Add AWS.Session.Control module.

	* aws-server.adb: 
	(Start): call Start from AWS.Session.Control was in AWS.Session.
	(Shutdown): call Shutdown from AWS.Session.Control was in AWS.Session.

	* aws-session.ads, aws-session.adb:
	(Start): moved to AWS.Session.Control.
	(Shutdown): moved to AWS.Session.Control.
	(Cleaner): moved from body to spec, needed for visibility from
	 AWS.Session.Control.
	(Cleaner_Control): idem.

	* aws-session-control.ads, aws-session-control.adb:
	Initial revision.

	* aws-services-directory.adb:
	Minor type fix.

	* aws-session.adb:
	(Add_Session): new entry into the Database protected record.
	(Save): new procedure.
	(Load): new procedure.

	* aws-session.ads:
	(Save): new procedure.
	(Load): new procedure.

2001-07-24  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-config.adb:
	(WWW_Root_Token): new constant.
	(WWW_Root_Value): new variable.
	(Parameters): add WW_Root handling into the table.
	(Program_Ini_File): correctly create the init filename from a
	 program name when it is launched using the full path name.
	(WWW_Root): new function.

	* aws-config.ads:
	(Default_WWW_Root): new constant.
	(WWW_Root): new function.

	* makefile:
	(build): do not build AWS.Services.Directory with optimization.

	* aws-session.adb: 
	(Cleaner_Control): new protected record to handle concurrent
	 access to the task cleaner creation.

2001-07-23  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session.adb:
	Lot of changes to avoid memory leak and copy of the whole session
	 table during iteration.
	Fix layout.
	
2001-07-23  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session.adb: 
	(Destroy): Destroy the root tree.
	(Generate_ID): new function.
	(Key_Exist): avoid raising an exception if the SID is not present
	 into the sessions table.
	(New_Session): use now Generate_ID to generate a uniq session ID.
	(Image): update to use new SID implementation.
	(Value): update to use new SID implementation.

	* aws-session.ads:
	(ID): type changed from an integer to a string.
	Minor style fix.

2001-07-22  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(SOURCES): add aws-services.ads and aws-services-directory.adb units.

2001-07-21  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-services-directory.adb:
	Remove use of AVL_Tree_Gereric and use now a new AVL
	 implementation which is not buggy.
	Add case sensitive, mime, extension ordering.
	Order (Ascending or Descending) is now based on the casing of the
	 option instead of using a specific option for this. This reduce
	 the Web parameters size to be sent to the server.
	Fix code layout.
	Add lot of comments.

	* aws-services-directory.ads:
	Add lot of comments.

2001-07-19  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-response.adb:
	(Binary): check for null pointer and returns an null array instead
	 of raising an exception.

2001-07-18  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-log.adb:
	(Log_Prefix): Fix bug when program is launched from the current
	 working directory with ./progname. In this case the program name
	 computed was the empty string.

	* makefile:
	(SOURCES): change aws-key_value.adb to aws-key_value.ads since
	 this unit based on new component does not require a body.
	(build): idem.

	* aws-config.adb:
	Fix minor casing error.

	* aws-key_value.adb:
	Removed as it is not used anymore with the new design.

2001-07-17  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-key_value.ads, aws-parameters-set.adb, aws-parameters.ads,
	  aws-parameters.adb, aws-session.adb:
	Remove use of AVL_Tree_Generic (it was quite buggy) and now use a new
	 component. This was a serious error causing session data to stay
	 forever or even to have strange value added. The AVL tree was
	 corrupt after some adding/removing operations.

2001-06-30  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session.adb:
	(Clean): Work around a GNAT bug when compiling with optimization on.

	* aws-client.ads:
	Reindent code.

	* aws-config.adb:
	(Hotplug_Port_Token): new constant.
	(Hotplug_Port_Value): new variable.
	(Hotplug_Port): new function.
	(Initialize): update comment.
	
	* aws-config.ads:
	(Default_Hotplug_Port): new constant.
	(Hotplug_Port): new function.

2001-06-23  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-*:
	Transfert the Copyright to ACTE.

	* aws-session.adb:
	(Session_Check_Interval): initialize using 
	 Config.Session_Cleanup_Interval.
	(Session_Lifetime): initialize using Config.Session_Lifetime.

	* aws-session.ads:
	(Default_Session_Lifetime): removed.

	* aws-server-get_status.adb:
	(Session_Table): add SESSIONS_TERMINATE_V.
	(Translations): add SESSION_CLEANUP_INTERVAL_V.

	* aws-config.adb: 
	(Session_Cleanup_Interval_Token): new constant.
	(Session_Lifetime_Token): idem.
	(Session_Cleanup_Interval_Value): new variable.
	(Session_Lifetime_Value): idem.
	(Session_Cleanup_Interval): new function.
	(Session_Lifetime): new function.
	(Parameters): add session lifetime and session cleanup interval.

	* aws-config.ads:
	(Five_Minutes): new constant.
	(Ten_Minutes): new constant.
	(Default_Session_Cleanup_Interval): new constant.
	(Default_Session_Lifetime): new constant.
	(Session_Cleanup_Interval): new function.
	(Session_Lifetime): new function.

2001-06-22  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-utils.ads, aws-utils.adb:
	(Image): on duration, new function.

	* aws-session.adb: 
	(Set_Session_Lifetime): renamed Set_Lifetime.
	(Get_Lifetime): new function.
	(Session_Check_Interval): new constant.
	(Cleaner): check for obsoltete session data every
	 Session_Check_Interval seconds instead of Session_Lifetime.
	(Database.Clean): can now removes many sessions at once.

	* aws-session.ads:
	(Set_Session_Lifetime): renamed Set_Lifetime.
	(Get_Lifetime): new function.

	* aws-server-protocol_handler.adb:
	Minor reformatting.

	* aws-server-get_status.adb:
	(Session_Table): Add Sessions_TS (time stamp).
	(Translations): idem.

2001-06-20  Pascal Obry  <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): is set to 1.0pre.

	* aws-hotplug.adb:
	Minor reformatting.

	* aws-config.adb:
	Minor reformatting.

2001-06-07  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-response.adb:
	(Authenticate): coirrectly set the Realm string (was setting
	 location string instead).

	* aws-session.adb:
	(remove): new procedure.
	(Database.Remove_Key): new entry.
	Fix comments.

	* aws-session.ads:
	(remove): new procedure.

2001-06-06  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-services-directory.ads, aws-services-directory.adb:
	Initial revision.
	
	* aws-services.ads:
	Initial revision.

2001-05-30  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-translator.ads, aws-translator.adb:
	(To_String): new function.
	(To_Stream_Element_Array): new function.
	Minor reformating.

	* aws-server-protocol_handler.adb:
	(Cut_Command): handle filename with spaces. This fix is needed for
	 Netscape which does not code space by %20 in the HTTP header.
	(URI): decode URL to handle filenames with spaces.
	(Target_Filename): Use Upload_Path as set in the HTTP object.

	* aws-client.adb:
	(Post): new function with Stream_Element_Array data type.
	(Post): idem with Keep-Alive connection.
	(Post): fix a bug when sending body, was using Put_Line so CRLF
	 was added making the body length 2 characters too long.

	* aws-client.ads:
	(Post): new function with Stream_Element_Array data type.
	(Post): idem with Keep-Alive connection.

	* aws-server.adb:
	Minor reformating.

	* aws-server-protocol_handler.adb:
	(Get_Message_Data): set message body (binary data) when reading
	 POST paramters. This will be needed for the hotplug module.

	* aws-hotplug.adb:
	(Apply): handle GET and POST hotplug request.

2001-05-29  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-config.adb:
	Add some comments, minor reformating.

	* aws-parameters.adb:
	(Count): correctly returns the number of parameters in the list
	 and not the total number of node in the tree.

	* aws-hotplug.adb: 
	(Apply): Removes URI parameter and add Status. Call hotplug module
	 with parameters.
	(Apply.Parameters): new function.

	* aws-hotplug.ads:
	(Apply): Removes URI parameter and add Status. 

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): when calling Hotplug.Apply pass full status
	 information and not just URI to be able to pass parameters to
	 hotplug module.
	(URI): call Decode_URL to be sure to decode encoded characters
	 into the URL. Fix problem with space in a filename.

2001-05-26  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-config.adb:
	Complete reimplementation. This unit is now based on a table. The
	 table filed are: the key name, a pointer to the variable which
	 hold the value and the type of the variable. It will be quite
	 easier to add new options with this implementation.
	This implementation is based on a patch supplied by Sune Falck.

	* aws-utils.ads, aws-utils.adb:
	Update copyright notice.

	* aws-translator.ads, aws-translator.adb:
	Update copyright notice.

	* aws.ads: 
	(Version): set to 0.11. Will probably be changed later to 1.0.

	* aws-parameters-set.adb:
	(Add): Handle case where the parameter name has some encoded
	 characters like $ or #.

	* aws-config.adb:
	Removed with GNAT.Regpat.
	(Process_Ini): use Strings.Fixed.Find_Token to parse the
	 file. Handle now properly the ini files.
	(Initialize): Fix typo in configuration file name.

	* aws-server-hotplug.ads, aws-server-hotplug.adb: 
	Update copyright notice.

	* aws-server-get_status.adb:
	Removes with AWS.Status.

	* aws-parameters.adb: 
	Update copyright notice.
	Fix typo.
	
	* aws-messages.ads, aws-messages.adb:
	Update copyright notice.

	* aws-hotplug.ads, aws-hotplug.adb:
	Update copyright notice.

2001-05-25  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-log.adb:
	Minor reformating.
	
	* aws-log.adb:
	Add with for Ada.Command_Line.
	Add with for AWS.Config.
	(Log_Prefix): new function.
	(Start): change log filename to use ISO date format.

	* aws-config.adb:
	(Proces_Ini): new procedure.
	(Program_Ini_File): new function.
	(Error_Message): add parameter Filename.
	(Regexp): add _ to match parameter name.
	(Initialize): process aws.ini and <program_name>.ini.

2001-05-24  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): Use Config.Logo_Image, Config.Status_Page,
	 Config.Up_Image and config.Down_Image instead of hard coded value.

	* aws-server-get_status.adb:
	Use Config.Status_Page instead of hard coded 'status.tmplt'.

	* aws-config.adb: 
	(Status_Page): new variable.
	(Up_Image): idem.
	(Down_Image): idem.
	(Logo_Image): idem.
	(Status_Page): new function.
	(Up_Image): idem.
	(Down_Image): idem.
	(Logo_Image): idem.

	* aws-config.ads:
	(Default_Status_Page): new constant.
	(Default_Up_Image): idem.
	(Default_Down_Image): idem.
	(Default_Logo_Image): idem.
	(Status_Page): new function.
	(Up_Image): idem.
	(Down_Image): idem.
	(Logo_Image): idem.

	* aws-server.ads:
	(Server_Processing): Fix comment.

	* aws-config.ads:
	Fix typo.

2001-05-21  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-response.ads, aws-response.adb:
	(Build): new function.
	(Message_Body): new function.

	* aws-server-protocol_handler.adb:
	(Send_Message): send message body as many chunk and update the
	 data timestamp between each.
	(Answer_To_Client): Set Phase to Server_Processing before calling
	 user's callback and put it to Server_Response just after.
	(Get_Message_Data): declare the buffer with the right size and
	 read data after.
	(Send_File): update the data timestamp.
	(Send_File_Chuncked): idem.

	* aws-server.adb:
	(Mark_Data_Time_Stamp): new procedure.
	(Is_Abortable): check for Data_Phase. We do not want to break a
	 transfert of big file.
	(Mark_Phase): if Phase is in Data_Phase adjust the data timestamp.
	Minor reformating.
	
	* aws-server.ads:
	(Slot_Phase): add Server_Processing.
	(Data_Phase): new subtype.
	(Timeouts): defined as constant.
	(Data_Timeouts): new constant.
	(Slot): add Data_Time_Stamp field.
	(Mark_Data_Time_Stamp): new procedure.

	* aws-config.adb: 
	(Send_Timeout): new function.
	(Receive_Timeout): new function.
	(Initialize): updated to parse Send_Timeout and Receive_Timeout.
	(Send_Timeout_Value): new variable;
	(Receive_Timeout_Value): new variable;
	
	* aws-config.ads:
	(Send_Timeout): new function.
	(Receive_Timeout): new function.
	(Default_Cleaner_Client_Data_Timeout): set to Height_Hours.
	(Default_Cleaner_Server_Response_Timeout): set to Height_Hours.
	(Force_Cleaner_Client_Data_Timeout): set to Three_Hours.
	(Force_Cleaner_Server_Response_Timeout): set to Three_Hours.
	
2001-05-19  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-config.adb:
	Fix casing.

	* aws-status.adb:
	(Count): removed.

	* aws-status-set.ads:
	Remove comment out code.
	Update copyright notice.

	* aws-server.adb: 
	(Slots.Get): is now a procedure was an entry.

	* aws-server.ads:
	(Timeouts): use AWS.Config*_Timeout function to initialize array.
	(Slots.Get): is now a procedure was an entry.

	* aws-server.adb: 
	(Start): add Upload_Directory parameter. Use default from
	 AWS.Config.

	* aws-server.ads:
	(Start): add Upload_Directory parameter. Use default from
	 AWS.Config.
	(HTTP): use default from AWS.Config.
	(Def_Admin_URI): new constant.
	(Def_Admin_Upload_Dir): new constant.
	(Def_Port): new constant.
	(Default_Connection): removed.
	(Default_Port): removed.
	(Default_Upload_Path): removed.
	(No_Admin): removed.
	
	* aws-communication-server.adb:
	(Receive): use new parameter interface.

	* aws-translator.ads, aws-translator.adb, aws-status-set.adb,
	  aws-parameters-set.adb, aws-client.adb:
	Rename Translater to Translat

	* aws-server-protocol_handler.adb:
	Call Mark_Phase after setting parameters.

	* aws-server.adb:
	Minor reformating.

	* aws-config.adb:
	(Cleaner_Wait_For_Client_Timeout_value): new variable.
	(Cleaner_Client_Header_Timeout_Value): new variable.
	(Cleaner_Client_Data_Timeout_Value): new variable.
	(Cleaner_Server_Response_Timeout_Value): new variable.
	(Force_Wait_For_Client_Timeout_Value): new variable.
	(Force_Client_Header_Timeout_Value): new variable.
	(Force_Client_Data_Timeout_Value): new variable.
	(Force_Server_Response_Timeout_Value): new variable.
	(Cleaner_Wait_For_Client_Timeout): new function.
	(Cleaner_Client_Header_Timeout): new function.
	(Cleaner_Client_Data_Timeout): new function.
	(Cleaner_Server_Response_Timeout): new function.
	(Force_Wait_For_Client_Timeout): new function.
	(Force_Client_Header_Timeout): new function.
	(Force_Client_Data_Timeout): new function.
	(Force_Server_Response_Timeout): new function.
	(Initialize): add parsing for all timeouts string.

	* aws-config.ads: 
	(Default_Server_Name): new constant.
	(Default_Admin_URI): new constant.
	(Default_Server_Port): new constant.
	(Default_Max_Connection): new constant.
	(Default_Log_File_Directory): new constant.
	(Default_Upload_Directory): new constant.
	(Default_Cleaner_Wait_For_Client_Timeout): new constant.
	(Default_Cleaner_Client_Header_Timeout): new constant.
	(Default_Cleaner_Client_Data_Timeout): new constant.
	(Default_Cleaner_Server_Response_Timeout): new constant.
	(Default_Force_Wait_For_Client_Timeout): new constant.
	(Default_Force_Client_Header_Timeout): new constant.
	(Default_Force_Client_Data_Timeout): new constant.
	(Default_Force_Server_Response_Timeout): new constant.
	(Cleaner_Wait_For_Client_Timeout): new function.
	(Cleaner_Client_Header_Timeout): new function.
	(Cleaner_Client_Data_Timeout): new function.
	(Cleaner_Server_Response_Timeout): new function.
	(Force_Wait_For_Client_Timeout): new function.
	(Force_Client_Header_Timeout): new function.
	(Force_Client_Data_Timeout): new function.
	(Force_Server_Response_Timeout): new function.

2001-05-18  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Read_Chunk): new implementation. Do not use a recursive algorithm
	 to read the data to work-around a problem with gigantic stack size
	 used to build the result. Patch contributed by Wiljan Derks.

	* aws-server.adb:
	(Check_Timeouts): removed.
	(Abort_On_Timeout): new parameter Done.
	(Free_Slot): new function.
	(Get): change entry guard.
	(Line_Cleaner): new implementation. Fix another problem with abortion.
	(Line): check if there is some slot available, if not force
	 abortion of one.
	
	* aws-server.ads:
	(Check_Timeouts): removed.
	(Abort_On_Timeout): new parameter Done.
	(Free_Slot): new function.

2001-05-18  Pascal Obry  <p.obry@wanadoo.fr>
	
	* aws-server-protocol_handler.adb:
	(P_List): new variable.
	Many changes in the code to use routines in AWS.Parameters instead
	 of the removed ones in AWS.Status. Cleaner design.
	Reset P_List at each iteration.
	Associate the P_List with the C_Stat at each iteration.

	* aws-status-set.ads, aws-status-set.adb:
	(Request): remove Parameters routine's parameter.
	(Parameters): renamed Binary.
	(Parameter): removed.

	* aws-status.adb: 
	(Parameter_Name): moved to AWS.Parameters.
	(Parameter): idem.
	(count): idem.
	(Normalize_Name): idem.
	(Parameter): new procedure to add a parameter list to the status 
	 record.
	Remove unused unit Ada.Characters.Handling.

	* aws-status.ads:
	(Data): remove discriminant.
	(Parameter_Name): moved to AWS.Parameters.
	(Parameter): idem.
	(count): idem.
	(Normalize_Name): idem.
	(Parameter): new procedure to add a parameter list to the status 
	 record.

	* aws-server.adb:
	Remove some debuging code.

	* aws-server-get_status.adb:
	Remove unused unit Interfaces.C.

	* aws-parameters.ads:
	Redesign. All routine to change the parameters list are now in a
	 child package.
	(Empty_Set): removed.
	(Set): renamed List.
	(Add): moved to child package.
	(Release): rename Reset and moved to child package.
	Update copyright notice.
	Reformating.
	
	* aws-parameters.adb:
	Redesign. All routine to change the parameters list are now in a
	 child package.
	(Add): moved to child package.
	(Release): rename Reset and moved to child package.
	Update copyright notice.
	Reformating.
	
	* aws-parameters-set.ads, aws-parameters-set.adb:
	Initial revision.

2001-05-15  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-status.adb:
	(Has_Session): new function.

	* aws-status.ads:
	(Has_Session): new function.
	(Normalize_Name): minor reformating.

	* aws-client.adb:
	Minor reformating.

2001-05-14  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Send_File): fix wrong order of header lines.

	* aws-client.adb:
	Minor reformating.

	* aws-server-get_status.adb:
	(Slot_Table): updated to use new Is_Abortable function. Remove
	 specific handling for missing peername. This is now handled by
	 the template page.

	* aws-server-protocol_handler.adb:
	(Send_File): correctly send Cookie: and Date: header when file is
	 up-to-date.

	* aws-server.adb:
	(Check_Timeouts): is now a function (was a procedure).
	(Abort_Oldest): removed.
	(Abort_On_Timeout): new procedure.
	(Is_Abortable): new function.
	(Set_Abortable): removed.
	(Abortable_Count): removed.
	(Get): change implementation, use now the timeouts.
	(Line_Cleaner): use the standard timeouts to check for abortion.
	 This is a better implementation using less active checks.

	* aws-server.ads:
	(Slot): remove Abortable field.
	(Timeout_Mode): new type.
	(Timeouts): new array.
	(Check_Timeouts): is now a function (was a procedure).
	(Abort_Oldest): removed.
	(Abort_On_Timeout): new procedure.
	(Is_Abortable): new function.
	(Set_Abortable): removed.
	(Abortable_Count): removed.

2001-05-13  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Send_File): Send Date: field in the 304 case (up to date).
	
	* aws-server-protocol_handler.adb:
	Set properly the status of the socket actvity using Mark_Phase.

	* aws-server.adb:
	(Mark_Activity_Time): removed.
	(Mark_Phase): added.
	(Check_Timeouts): new procedure.
	(Set_Abortable): new procedure.
	Many changes to use new field Phase and Phase_Time_Stamp instead
	 of Opened and Activity_Time_Stamp.
	(Line_Cleaner): new algorithm to detect client not sending data
	 for some time. In this case we mark the slot Abortable.

	* aws-server.ads:
	(Client_Header_Timeout): new constant set to 5 seconds.
	(Slot): remove Opened and Activity_Time_Stamp fields, add Phase
	 and Phase_Time_Stamp.
	(Mark_Activity_Time): removed.
	(Mark_Phase): added.
	(Check_Timeouts): new procedure.
	(Set_Abortable): new procedure.
	(HTTP): add comments for the fields.
	
	* aws-server-get_status.adb:
	(Slot_Table): do not use Opened but Phase.

2001-05-09  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session.ads:
	(ID): defined using Max_Int.

	* aws-hotplug-get_status.adb:
	Use suffix _V for vector tag (was _L for historical reasons).
	
	* aws-server-get_status.adb:
	(Session_Table): Update to use Matrix_Tag. There is no more HTML
	 tag hard coded. Use suffix _V for vector tag (was _L for
	 historical reasons).

	* aws-server-protocol_handler.adb:
	(Parse): fix bug in parsing the Cookie line. Some format were not
	 supported.

2001-05-07  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session.adb:
	A lot of changes to simplify the code to handle session data. The
	 AVL tree now use the SID instead of the string image of
	 it. Change all routines to support this new architecture. This
	 simplification should also improve the performance.

	* aws-response.ads:
	(URL): fix comment.

	* aws-session.adb:
	(Delete): new procedure.
	(SID_Random): new package.
	(SID_Generator): new variable.
	(Database.Delete_Session): new entry.
	(Clean): variable Now is now a constant.
	(New_Session): change implementation to used to random session ID.
	Reset SID_Generator at package elaboration.

	* aws-session.ads:
	(Delete): new procedure.
	(ID): change to a larger interger based type.

2001-05-06  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-status.adb:
	Minor reformating.

	* aws-server.ads:
	Update comment.

	* aws-response.ads:
	Minor reformating.
	Update copyright notice.

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): Set Peername before calling user's callback.

	* aws-status.adb:
	(Peername): new function.

	* aws-status.ads:
	(Data): add field Peername.
	(Peername): new function.

	* aws-status-set.ads, aws-status-set.adb:
	(Peername): new procedure.

	* aws-server.adb:
	(Abort_Oldest): raise Internal_Error instead of displaing a bug
	 message. This should never happen anyway.

	* aws-response.ads:
	(Default_Handler): removed.

	* aws.ads:
	(Version): set 0.10.
        Update copyright notice.

	* aws-status.adb: 
	(Parameter): remove Case_Sensistive parameter. More efficient
	 implementation in the non case sensitive case.
	(Normalize_Name): new procedure.
        Update copyright notice.

	* aws-status.ads:
	(Data): add discriminant Parameters_Case_Sensitive. Default is set
	 to True. CGI parameters are case sensitive by default.
	(No_Data): removed.
	(Parameter): remove Case_Sensistive parameter.
	(Normalize_Name): new procedure.
        Update copyright notice.

	* aws-status-set.adb:
	(Parameters): Set name to upper case if no case sensitive parameters
	 requested.
	(Reset): Free Binary_Data parameter (avoid memory leak). Initialize
	 all parameters to their default value.
        Update copyright notice.

	* aws-server.adb:
	(Start): add many parameters that were HTTP discriminant. Initialize 
	 HTTP new parameters.
	(Set_Abortable): better implementation.
	(Abort_Oldest): better implementation.
	(Get): is now a protected entry. (better implementation). We
	 should not call this entry if there is no free slot available
	 except if some Slot have an abortable state. This should fix some
	 browser hanging.
	(Line): do not anymore output message about line beeing
	 closed. This was a message for the AWS early days to ease
	 debugging and does not need to be there anymore.
        Update copyright notice.
	
	* aws-server.ads:
	(HTTP): remove all discriminants except Max_Connection. All values
	 will be set by the Start procedure. This is more dynamic.
	(Start): add many parameters that were HTTP discriminant.
	(Abort_Oldest): fix comments.
	(Slots): add Abortable_Count variable.
        Update copyright notice.

	* aws-server-protocol_handler.adb:
	Call Status.Set.Reset at start of the loop (simplify code).
	(C_Stat): Add discriminant to declaration.
	(Will_Close): handle case for Netscape HTTP/1.0 and Keep-Alive
	 connection. Should fix some more server hanging.
        Update copyright notice.
	
	* aws-communication-server.adb:
	(Start): use new HTTP definition (only one discriminant) others
	 setting are done through the Server.Start procedure.
        Update copyright notice.

2001-05-04  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-get_status.adb:
	(Slot_Table): Add Peer_Name to the vector tag list (PEER_NAME_L).

2001-05-02  Pascal Obry  <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): set to 0.9.12.

	* aws-session.adb:
	(UID): new type.
	(SID_Prefix): new string constant.
	(New_Session): session ID is now based on the current time to be
	 sure that a session ID is uniq. This was not the case before and
	 in some case 2 clients could have the same SID, hence sharing the
	 same session data.
	(Image): use SID_Prefix.
	(Value): use SID_Prefix'Length.

	* aws-session.ads:
	(ID): change type to a 40 bits integer based value.

	* aws-server-protocol_handler.adb:
	(Parse): fix cookie token offset when reading the the cookie
	 data. This was a serious bug in the AWS session feature.

2001-05-01  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): use PNG images instead of GIF images for
	 built-in server status page.

2001-04-29  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Get): init Persistent field to False.
	(Head): idem.
	(Put): idem.
	(Post): idem.
	(Persistence): new function.
	(Send_Command): do not always send Keep-Alive, use new Persistence
	 function.
	(Create): add Persistent parameter to create a Keep-Alive
	 connection.

	* aws-client.ads:
	(Create): add Persistent parameter to create a Keep-Alive
	 connection.
	(HTTP_Connection): add Persistent field.

	* aws-server-protocol_handler.adb:
	(Will_Close): fix test, we want a keep-alive connection by default
	 (i.e. client says nothing about the connection).

	* aws-server.ads:
	(Keep_Open_Duration): set to 80 seconds to match standard browser
	 expectation.

2001-04-28  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(clean): remove build_std file. Was preventing to build a non SSL
	 AWS version after a SSL one.

	* aws.ads:
	(Version): set to 0.9.11.

	* aws-server.adb:
	(Increment_Slot_Activity_Counter): new procedure.

	* aws-server.ads:
	(Slot): add Slot_Activity_Counter.
	(Increment_Slot_Activity_Counter): new procedure.

	* aws-server-protocol_handler.adb:
	Set increment slot activity counter.
	Fix check for "close" connection (if not keep-alive).

	* aws-server-get_status.adb:
	Add handling of slot activity counter.

	* aws-messages.ads, aws-messages.adb:
	(Does_Not_Match): new function.

	* aws-client.adb:
	(Disconnect): use proper order for Is_Math parameters.
	(Put): idem.
	
	* aws-server-protocol_handler.adb:
	(Will_Close): new boolean.
	(Header_Date_Serv): removed.
	(Send_Connection): removed.
	(Send_General_Header): new procedure implementing
	 Header_Date_Servname and Send_Connection.
	(Protocol_Handler): set Will_Close before answerting to the client
	 to be sure that we are sending the "close" request before
	 actually closing the socket (Fix from Dmitriy Anisimkov). This
	 patch will certainly fix problem with hanging browser, waiting
	 for an answer from the server.

2001-04-27  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	Minor reformating.
	(Answer_To_Client): Use URL API instead of Moved.
	(Send_File): let Name_Error propagate outside of the routine.

	* aws-hotplug-get_status.adb:
	Many changes to use new Templates_Parser API.

	* aws-server-get_status.adb:
	Lot of changes to use new Templates_Parser API.

	* aws-response.adb:
	(URL): new function.

	* aws-response.ads:
	(URL): new function.
	Minor reformating.

	* aws-mime.adb: 
	Minor reformating.

2001-03-13  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-net.ads:
	Minor style update.

	* aws-net-ssl.adb:
	(Init): do not propagate Lib_Error exception if the default
	 certificate has not been found. The certificate could be selected
	 by users later.

2001-03-10  Pascal Obry  <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): set to 0.9.10

	* aws-server.adb:
	(Geet_Peername): Fix C_Getpeername call prototype to match latest
	 version of Adasocket.

	* aws-server-get_status.adb:
	(Slot_Table): do not ouput Socket value if it is not open.

	* aws-config.adb:
	(Regexp): fix typo (patch from Sune Falck).

2001-03-06  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	Minor reformatting.

	* aws-messages.ads:
	(Authorization): new function.
	(Host): new function.
	(Proxy_Connection_Token): new constant.
	(Proxy_Connection_Range): new subtype.
	(Proxy_Connection): new function.
	(Accept_Token): new constant.
	(Accept_Range): new subtype.
	(Accept_Type): new function.
	(Accept_Laguage_Token): new constant.
	(Accept_Language_Range): new subtype.
	(Accept_Language): new function.
	(Proxy_Authorization_Token): new constant.
	(Proxy_Authorization_Range): new subtype.
	(User_Agent_Token): new constant.
	(User_Agent_Range): new subtype.
	(User_Agent): new function.

	* aws-messages.adb:
	(Proxy_Connection): new function.
	(User_Agent): new function.
	(Accept_Language): new function.
	(Accept_Type): new function.
	(Proxy_Connection): new function.
	(Authorization): new function.
	(Host): new function.
	
	* aws-client.ads, aws-client.adb:
	(HTTP_Connection): new private type (keep-alive client
	 implementation, checked-in for Dmitriy Anisimkov)
	(Create): new procedure.
	(Get): new procedure.
	(Head): new procedure.
	(Put): new procedure
	(Post): new procedure.
	(Close): new procedure.
	(Retry_Defaul): new constant.
	Improve comments.

2001-03-05  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	Simplify it and add some comments.

2001-02-16  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Get_Message_Data): Use Content_Length to read POST message
	 data. Avoid to lost some data.

	* aws-translater.adb: 
	(Base64_Decode) Fix problem with '=' handling.

2001-01-10  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Send_File): handle exception when a file is not found. We don't
	 want to crash in this case.
	(File_Upload): handle properly the server name on the server side.
	(Answer_To_Client): return an error message in case status.tmplt
	 file can not be found.

	* aws-communication-server.ads:
	Fix comments.

2001-01-03  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Get_Response): Use MIME type declaration instead of strings.

	* aws-server-protocol_handler.adb:
	(Protocol_Handler): Use MIME type declaration instead of strings.

	* aws-response.ads:
	(Acknowledge): Use MIME type declaration instead of strings.
	Fix typo.

	* aws-response.adb:
	(Acknowledge): Use MIME type declaration instead of strings.
	(Authenticate): idem
	(Moved): idem

	* aws-os_lib.adb:
	(GMT_Clock): Fix month number.

	* aws-mime.adb:
	MIME type declarations moved to the spec. Fix casing.

	* aws-mime.ads:
	Move MIME type declaration here from the body.

2000-11-21  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-os_lib.adb:
	(Is_Regular_File): do not return an exception but return False if
	 file does not exist.
	(Is_Directory): idem.

2000-11-12  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-response.adb:
	Put routine in alpha order.

	* aws-response.ads:
	Comment API.

	* aws-server-protocol_handler.adb:
	Lot of change to use AWS.Status.Set instead of AWS.Status.

2000-11-12  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-status.adb:
	Move all routines to set the status to aws-status-set.adb.
	Set routine in alpha order.

	* aws-status.ads:
	Move all routines to set the status to aws-status-set.ads. This is
	cleaner from a user point of view as this unit contain only
	usefull routines.

	* aws-status-set.ads, aws-status-set.adb:
	Initial revision.

	* aws-server-protocol_handler.adb:
	(Target_Filename): use Config.Upload_Directory instead of the
	 obsolete one in AWS.Server.Config.

	* aws-config.adb:
	(Upload_Directory): new function.
	(Initialize): handle Upload_Directory parameter.
	
	* aws-config.ads:
	(Upload_Directory): new function.

2000-11-11  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	Minor comment update.

	* aws-log.adb:
	(Start): add Split parameter.
	(Write): check if log file need to be changed (daily, monthly).
	
	* aws-log.ads:
	(Split_Mode): new type.
	(Start): add Split parameter.
	Update comments.

	* aws-config.ads, aws-config.adb:
	Initial revision.

2000-11-09  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Send_File): do not propagate exception.

2000-10-29  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-net.ads:
	Comment unit.

2000-10-28  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Get_Response): new parameter Get_Body. Read message body only if
	 Get_Body is set.
	(Head): new function.
	
	* aws-client.ads:
	(Head): new function.

	* aws-os_lib.adb:
	(GMT_Clock): renaming of OS_Clock. Correct implementation that
	 does return the GMT time.

	* aws-os_lib.ads:
	(GMT_Clock): renaming of OS_Clock.

	* aws-server-protocol_handler.adb:
	(Header_Date_Serv): use GMT_Clock (was OS_Clock).

2000-10-22  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-communication-server.adb:
	Add missing Receive prototype. (fix style error).

	* makefile:
	(SOURCES): add aws-log.adb aws-hotplug.adb aws-communication.adb
	 aws-communication-server.adb aws-communication-client.adb
	 aws-server-hotplug.adb

	* aws-hotplug.adb:
	(Apply): fix style error.

	* aws-utils.adb:
	(Gethostname): fix style error.

	* aws-hotplug.ads, aws-hotplug.adb:
	(Move_Up): new procedure.
	(Move_Down): new procedure.

	* aws-server-get_status.adb:
	(Get_Status): add ADMIN tag in the Translations table.

	* aws-server-hotplug.adb:
	(Message): Use string constants Register_Message and
	 Unregister_Message.

	* aws-server-hotplug.ads:
	(Register_Message): new string constant.
	(Unregister_Message): new string constant.

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): Handle hotplug status page items.

2000-10-22  Pascal Obry  <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): set to 0.9.9.

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): look for Hotplug module before using the
	 server's default callback procedure. Handle hotplug status page
	 items.

	* aws-communication-client.adb:
	(Gethostname): moved to AWS.Utils.
	(Send_Message): use AWS.Utils.Gethostname.

	* aws-communication-server.adb:
	Removes code to start Server from the package elaboration code
	 This will now be done at runtime by the start procedure.
	(Start): new procedure.
	(Context): new global variable.
	(Com_Server): is now an HTTP_Access.
	(Shutdown): free the memory associated with the Com_Server.
	(Receive): pass the Context to the callback.

	* aws-communication-server.ads:
	Removes generic formal parameter Port and add a type T (and its
	 access type). This is to be able to pass a context to the
	 Callback generic formal function.
	(Start): new procedure.
	
	* aws-communication.ads:
	(Parameters): improve comments.

	* aws-server.adb:
	Add with AWS.Session.

	* aws-server.ads:
	(HTTP_Access): type moved outside the private section.
	(HTTP): add field Filters.

	* aws-utils.adb:
	(Gethostname): new function.

	* aws-utils.ads:
	(Gethostname): new function.
	Removes pragma pure.

	* aws-server-get_status.adb:
	Add Hotplug translate table.

	* aws-hotplug-get_status.ads, aws-hotplug-get_status.adb:
	Initial revison.

	* aws-server-hotplug.ads, aws-server-hotplug.adb:
	Initial revision.

	* aws-hotplug.ads, aws-hotplug.adb:
	Initial revision.

2000-10-20  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-net-std.adb:
	Minor comment casing fixes.

	* aws-mime.adb:
	(Dot_Jpeg): fix string value.

2000-10-18  Pascal Obry  <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): set to 0.9.5.

	* aws-communication-client.ads, aws-communication-client.adb:
	Initial revision.

	* aws-communication-server.ads, aws-communication-server.adb:
	Initial revision.

	* aws-communication.ads, aws-communication.adb:
	Initial revision.

2000-10-17  Pascal Obry  <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): set to 0.9.2 (previous check-in was wrong).

	* aws-session.ads, aws-session.adb:
	(Shutdown): new procedure.

	* aws-server.adb:
	(Start): start session server only if needed.
	(Shutdown): stop session server.
	(Line): do not display error message if we are in a shutdown process.

	* aws-server.ads:
	(HTTP): add boolean field Shutdown.

2000-10-16  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(SOURCES): add aws-utils.adb, aws-key_value.adb and aws-log.adb
	
	* aws.ads:
	(Version): set to 0.9.2.

	* aws-session.adb:
	(Get_Value): Use new Update_Node prototype.
	(Key_Exist): Use new Update_Node prototype.
	(Set_Exist): Use new Update_Node prototype.
	Remove comment out code.

	* aws-log.ads, aws-log.adb:
	Initial revision.

	* aws-parameters.adb:
	(Image): removed use Utils.Image instead.
	(Add): Use new Update_Node prototype.
	
	* aws-server.adb:
	(File_Upload_UID): new protected object.
	(Set_Peername): new procedure.
	(Get_Peername): new procedure.
	(Get_Peername): new procedure.
	Removes unused with (not used anymore with GNAT 3.13)

	* aws-server.ads:
	(Slot): add Peername field.
	(Set_Peername): new procedure.
	(Get_Peername): new procedure.

	* aws-utils.ads, aws-utils.adb:
	Initial revision.

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): write log.
	(Target_Filename): add a UID to the name to avoid name clash.
	Use Utils.Image instead of a local version.

2000-10-14  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.ads:
	(HTTP): move up Self field.

	* aws-parameters.ads, aws-parameters.adb, aws-session.adb:
	Remove use of Avl_Tree_Generic, implementation now use
	 AWS.Key_Value package shared by two units right now. It reduces
	 the overall size of AWS executables.

	* aws-key_value.ads, aws-key_value.adb:
	Initial revision.

2000-10-10  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-status.ads:
	(Count): new function.
	(Parameter): add parameter N.

	* aws-parameters.adb:
	Add some documentation about the underlying implementation.
	(Internal_Get): new function.
	(Add): support Key with multiple values.
	(Count): new function.
	(Get): add parameter N, use Internal_Get.

	* aws-parameters.ads:
	(Count): new function.
	(Get): add parameter N.

	* aws-status.adb:
	(Set_Parameters): fix bug when parsing an empty parameter at the
	 end of the list.
	(Count): new function.
	(Parameter): add parameter N, implement returning the Nth value.

2000-10-09  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Send_Message): send Location field is needed.

	* aws-response.adb:
	(Acknowledge): add initialization for new Location field.
	(Authenticate): add initialization for new Location field.
	(Build): add initialization for new Location field.
	(Moved): new function.
	(File): add initialization for new Location field.
	(Location): return the Location field.
	
	* aws-response.ads:
	(Default_Moved_Message): new constant.
	(Moved): new function.
	(Data): Add field Location.

	* aws-messages.ads, aws-messages.adb:
	(Location): new function.

2000-10-08  Pascal Obry  <p.obry@wanadoo.fr>

	* makefile:
	(SOURCES): update list.
	(build): add build step for AWS.Parameters unit.

	* aws-client.adb:
	(Init_Connection): Host header data must reference the target
	 computer and not the proxy.
	Removes unused units.

	* aws-server-protocol_handler.adb:
	Fix bad casing and layout.

	* aws-server-config.ads:
	Fix bad casing.

	* aws-server-protocol_handler.adb:
	(Target_Filename): moved (one level up).
	(File_Upload): better way to check for file upload mode. Fix
	 algorithm to detect empty file upload parameter. Use new
	 Set_Parameter procedure.

	* aws-status.adb:
	Removes Ada.Text_IO (not used).
	(Set_Parameters): new procedure.

	* aws-status.ads:
	Minor reformating.
	(Set_Parameters): new procedure.

2000-10-04  Pascal Obry  <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): set to 0.9.

	* aws-status.ads:
	(Reset): new procedure.
	(Set_Multipart_Boundary): new procedure.
	(Multipart_Boundary): new function.
	(Data): parameter field is now a AWS.Parameters.Set.
	Add some comments.
	
	* aws-status.adb:
	(Multipart_Boundary): new function.
	(Parameter): complete reimplementation (more efficient now).
	(Parameter_Name): idem.
	(Reset): new procedure.
	(Set_Multipart_Boundary): new procedure.
	(Set_Parameters): complete reimplementation (more efficient now).
	(Set_Request): call to Set_Parameters to setup the form
	 parameters.
	
	* aws-server.ads:
	(Default_Upload_Path): new constant.
	(HTTP): add field Upload_Path.

	* aws-server.adb:
	(Start): set the Web_Server.Upload_Path	to the default value.

	* aws-server-protocol_handler.adb:
	(File_Upload): new procedure.
	(Value_For): new function.
	(Get_Message_Data): add some comments. Check if we have a
	 multipart form data (file upload) to handle.
	(Parse): correctly handle the Content-Type line. A Content-Type
	 can be followed by a boundary information when uploading a
	 file. Set the Multipart_Boundary if needed.
	(Protocol_Handler): reset the status data before handling a new
	 request.

	* aws-messages.ads:
	(Multipart_Form_Data): new constant.
	
2000-10-03  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-config.ads, aws-server-config.adb:
	Initial revision.

2000-10-01  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-parameters.ads, aws-parameters.adb:
	Initial revision.

2000-09-21  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.ads:
	(Slot): removes Quit field (was not used anymore).

	* aws-server.adb:
	(Get): properly set Abortable status here. minor reformating.
	(Line): removes call to Set_Abortable.

	* aws-server-protocol_handler.adb:
	(Answer_To_Client): minor reformating.
	(Get_Message_Header): set abortable status here.
	(Protocol_Handler): remove call to Set_Abortable.

	* aws-server-get_status.adb:
	removes Quit variable (does not exist anymore).

2000-09-20  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Send_File): close file if there is an exception raised during
	 transfert.

2000-09-16  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-mime.ads:
	Add some comments.

2000-09-11  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Get_Host_Name): removed.
	(Port_Not_Default): new function.
	(Open_Socket): send correct "Host:" field.
	(Init_Connection): minor change to User-Agent field value.

2000-09-10  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Header_Date_Serv): Use OS_Lib.OS_Clock instead of Calendar.Clock.

	* aws-response.adb: 
	(Acknowledge): add Content_Type string.
	Properly set the content type when message body non empty.

	* aws-response.ads:
	(Acknowledge): add Content_Type string.

2000-09-09  Pascal Obry  <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): set to 0.8.2.

	* aws-client.adb:
	Minor reformating.

2000-09-07  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session.adb: 
	(Cleaner): update Next_Run.

	* aws-server-protocol_handler.adb:
	Remove POSIX withed units, use AWS.OS_Lib instead.
	(File_Timestamp): removed.
	(Send_File_Time): new procedure.
	(Send_File_Size): new procedure.
	(Is_Valid_HTTP_Date): new function.
	(Header_Date_Serv): minor reformating.
	(Send_File): check that the HTTP date filed is correctly
	 formated. Handle correctly HEAD method (From Sune Falck).
	(Send_File): remove use of POSIX. Send file in piece instead of
	 reading and sending the whole file. Should fix problem with very
	 big file. (From Sune Falck).
	
	* aws-os_lib.ads, aws-os_lib.adb: 
	Initial revision.

2000-09-05  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb: 
	Add comments.
	Minor reformating.

2000-09-04  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb:
	(Answer_To_Client.Send_File): fix check for up-to-date file (fix
	 from Sune Falck).
	(Send_File): open file with shared=no (fix from Sune Falck).
	(Send_File.Send_File): remove a newline sent to the socket (fix
	 from Sune Falck).
	
	* aws.ads:
	(Version): set to 0.8.1.

	* aws-net-ssl.adb: 
	(Connect): minor indentation.

	* aws-server-protocol_handler.adb: 
	(Protocol_Handler): HTTP_Server parameter changed to "in out" mode.

	* aws-server.adb:
	(Protocol_Handler): HTTP_Server parameter changed to "in out" mode.

	* aws-server.ads:
	(Slot): initialize Activity_Time_Stamp.
	(Slots_Access): type removed.
	(HTTP): field slot is a protected type (was a protected access).

2000-09-02  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-session.adb: 
	(Start): new procedure.
	(Cleaner): is now a task type.
	(Cleaner_Task): a pointer to a Cleaner task.

	* aws-session.ads:
	(Start): new procedure.

	* aws-server.adb: 
	(Start): call Session.Start to start session server.

	* aws-session.adb:
	Fix some bad casing. Remove a space.

	* aws.ads: 
	(Version): set to 0.8.

	* aws-status.ads: 
	(Session): ne functions.
	(Set_Session): new procedure.
	(Data): add Session_ID field to this record.
	(No_Data): add intialization for new field Session_ID.
	
	* aws-status.adb:
	(Session): ne functions.
	(Set_Session): new procedure.

	* aws-server.ads: 
	(Keep_Open_Duration): set to 30 seconds (was 120).
	(HTTP): add Session field.

	* aws-server-protocol_handler.adb: 
	(Send_Session_Cookie): new boolean.
	(Create_Session): new procedure.
	(Header_Date_Serv): send a cookie to the client browser if needed.
	(Answer_To_Client): add code to return the AWS status page
	 logo. Call Create_Session to initialize session.
	(Parse): handle cookie.

	* aws-server-get_status.adb:
	(Session_Table): new function.
	(Slot_Table): rename all tag variable to end by _L and not _T
	(Get_Status): add tag variables LOGO and SESSION.

	* aws-messages.ads: 
	(Cookie_Token): new constant.
	(Cookie_Range): new subtype.

	* aws-session.ads, aws-session.adb: 
	Initial revision.

2000-09-01  Pascal Obry  <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): set to 0.7

	* aws-server-get_status.ads: 
	Initial revision.

	* aws-server-get_status.adb: 
	Initial revision.

	* aws-server.adb:
	(Protocol_Handler): simplify prototype now that we have a
	 reference to the HTTP server (no need to drag around so much
	 data). 
	(Line): remove many variable not needed anymore.
	(Start): add Admin_URI parameter.
	
	* aws-server.ads:
	(HTTP): add the field Self to the record. It is an auto-pointer
	 (i.e. pointing to itself).
	(Start): add Admin_URI parameter.

	* aws-server-protocol_handler.adb:
	(Protocol_Handler): simplify prototype now that we have a
	 reference to the HTTP server (no need to drag around so much
	 data). Simplify the code to use the HTTP reference.

	* aws-messages.ads: 
	Fix typo.

2000-08-27  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-response.ads, aws-response.adb:
	(Acknowledge): add Message_Body parameter.

2000-08-23  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-translater.adb:
	(Decode_URL): fix a problem with null string parameter.

2000-08-14  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server-protocol_handler.adb: 
	(Get_Message_Data): do not decode URL parameters here.
	(Parameters): do not decode URL parameters here.

	* aws-server.adb: 
	remove withed unit Translater (not used anymore).

	* aws-status.adb: 
	(Parameter): decode URL parameter.

	* aws-status.ads:
	(Set_Authorization): new procedure
	(Authorization_Name): new function
	(Authorization_Password): new function
	(Data): new field Auth_Name and Auth_Password.
	
	* aws-status.adb:
	(Set_Authorization): new procedure
	(Authorization_Name): new function
	(Authorization_Password): new function
	
	* aws-server-protocol_handler.adb: 
	Handle authorization protocol.

	* aws-messages.ads: 
	Add Authorization_Token
	Sort constants in alphabetical order.

2000-08-01  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-server.adb:
	(Line): minor text message change.

	* aws-server-protocol_handler.adb:
	(Get_Message_Data): correctly detect a closed socket.
	(Get_Message_Header): idem

2000-07-28  Pascal Obry  <p.obry@wanadoo.fr>

	* aws-net-ssl.adb: 
	(Accept_Socket): remove call to Init.
	(AWS.Net): add call to Init during elaboration of the package.

2000-07-26    Pascal Obry <p.obry@wanadoo.fr>

	* aws.ads:
	(Version): updated to 0.6
	
	* aws-net.ads:
	Fix copyright notice.
	
	* aws-server.adb:
	Fix minor typo.

2000-07-26    Pascal Obry <p.obry@wanadoo.fr>

	Integration of Dmitriy Anisimkov SSL implementation into AWS.

	* aws.ads:
	(Connection_Error): new exception.

	* aws-client.ads:
	(Post): new function.
	Fix copyright notive.

	* aws-client.adb:
	(Post): new function.
	(Init_Connection): add support for POST method
	(Open_Socket); new function.
	Fix copyright notive.

	* aws-net.ads:
	Initial revision
	
	* aws-net-ssl.adb:
	Initial revision
	
	* aws-net-std.adb:
	Initial revision

	* aws-server.ads:
	(Get): update comments
	(HTTP): add field Security.
	
	* aws-server.adb:
	Use AWS.Net
	(Line): handle security.

	* aws-server-protocol_handler.adb:
	Sock parameters is now a Socket_FD'Class.

	* aws-status.adb:
	Minor casing fix.
	
	* aws-url.ads:
	(Security): new function
	(Object): new field Security

	* aws-url.adb:
	(Parse): add support for HTTPS
	(Security): new function
	
2000-04-05    Dmitriy Anisimkov <anisimkov@iforex.net>

	* aws-client.adb:
	(Parse_Header): correctly initilialize Content_Length.
	
	* aws-connection.ads, aws-connection.adb:
	Removed not needed anymore.
	
	* aws-server.ads, aws-server.adb:
	Complete rewrite. more efficent implementation.

	* aws-server-protocol_handler.adb
	Initial revision. (most of the code here comes from AWS.Connection).

2000-04-05    Dmitriy Anisimkov <anisimkov@iforex.net>

	* aws-connection.ads:
	(Slot): add Aborted field.
	
	* aws-connection.adb:
	(Abort_Slot): new procedure
	(Line): use Abort_Slot. general cleanup.
	(Line_Cleaner): use Abort_Slot instead of Sosckets.Shutdown
	(Get_Free_Slot): idem
	
2000-04-01    Pascal Obry <p.obry@wanadoo.fr>

	* aws-client.adb, aws-connection.adb, aws-messages.adb,
	  aws-translater.adb, aws-url.adb:
	Minor reformatting to conform to -gnaty switch.
	
2000-04-01    Pascal Obry <p.obry@wanadoo.fr>
	
	* aws.ads
	(Version): changed to 0.4
	
	* aws-connection.ads:
	(Slot): moved here from the body as a limited private type. Abortable, 
	 Activity_Time_Stamp, Sock fields added.
	(Line): add access to Slot discriminant

	* aws-connection.adb:
	(Slot): moved to spec
	(Counter): rename Free to Release. Free is now a function
	 returning True if some free Slot are available.
	(Free): removed.
	(Line_Cleaner): added
	(Line): Shut down properly the sockets when needed.
	(Get_Free_Slot): try abort some line slot if there is no free one.

2000-03-10    Pascal Obry <p.obry@wanadoo.fr>

	* aws-connection.adb: 
	(Line): never exit with an exception from the outer loop in this
	task. We have a pool of Line that gets recycled.
	
2000-03-05    Pascal Obry <p.obry@wanadoo.fr>

	* aws-connection.adb:
	(line): do not send a message to the client when an exception has
	 occured since this is because the server has most certainly
	 closed the connection. (fixes from Dmitriy Anisimkov)

2000-02-14    Pascal Obry <p.obry@wanadoo.fr>

	* aws-client.adb:
	(Get): Handle status 301 (moved permanently) with Location message.
	(Read_Message): new function

	* aws-messages.ads:
	(Location_Token): new constant

	* aws-response.ads, aws-response.adb:
	(Location): new function
	
2000-02-05    Pascal Obry <p.obry@wanadoo.fr>

	* aws-clients.adb:
	(Put): new function
	(Init_Connection): new function
	(Parse_Header): new function
	(Get): reorganized - use Init_Connection to Parse_Header

	* aws-clients.ads:
	(Put): new function

	* aws-messages.ads:
	(Head_Token): new constant
	(Form_Data): new constant
	(Content_Length): parameter changed from Positive to Natural
	(Www-Authenticate): new function
	
	* aws-messages.adb:
	(Content_Length): parameter changed from Positive to Natural
	(Www-Authenticate): new function
	
	* aws-response.ads:
	(Data_Mode): add Header to the enumeration
	(Content_Length): parameter changed from Positive to Natural
	(Acknowledge): new function
	
	* aws-response.adb:
	(Content_Length): parameter changed from Positive to Natural
	(Acknowledge): new function
	
	* aws-status.ads, aws-status.adb:
	(Set_Parameter): new function with Stream_Element_Array data
	(Set_Content_Type): new function
	(Content_Type): new function
	(Binary_Data): new function
	
	* aws-connection.adb:
	A lot of changes to handle PUT method and handle POST method with
	binary data.
	
2000-02-04    Pascal Obry <p.obry@wanadoo.fr>

	* aws-clients.adb:
	(Get_Host_Name): new function use to get the host name to send to
	the server.

	* aws-messages.adb:
	(Weekday): fix minor bug (use local var for time) 
	[patch from Sune Falck]

2000-01-24    Pascal Obry <p.obry@wanadoo.fr>

	* aws.ads:
	(Internal_Error): exception added.
	
	* aws-client.adb:
	(Get): Fix sockets interface to use the UNIX compliant one.

	* aws-connection.adb:
	(Internal_Error): exception removed.
	
	* aws-messages.adb:
	(Status_Code_Image): new type to handle 3 digits status code
	(Status_Data): Code is now a Status_Code_Image
	(Status_Messages): change declaration to match new design.

2000-01-24    Sune Falck <Sune.Falck@swipnet.se>

	* aws-messages.adb:
	Changed Image to handle Natural instead of Positive, gave
	constraint_error for 0 in seconds and minutes. Image now returns a
	leading zero for numbers with only one digit so that time and day
	representation will be correct. Changed Month_Name to an array
	instead of a function. Changed Month_Number to use the array
	Month_Name. Added function Weekday.

2000-01-22    Pascal Obry <p.obry@wanadoo.fr>

	* aws*.ad[sb]: this is to be considered the first version of AWS

2000-01-16    Pascal Obry <p.obry@wanadoo.fr>
	
	* aws*.ad[sb]: this is the very first release.
